<!-- Place this inside review.html (adult-only page) -->
<!-- Container where the button will be injected -->
<div data-parent-controls></div>

<script type="module">
  import { initParentSeedButton } from './parentSeedButton.js';
  import { supabase } from './supabaseClient.js';

  // Replace this with however your app exposes the current household id:
  async function getActiveHouseholdId() {
    // Example: read from a global or fetch the first household for the logged-in adult
    // You can replace this with your existing logic
    if (window.activeHouseholdId) return window.activeHouseholdId;

    const user = (await supabase.auth.getUser()).data.user;
    if (!user) throw new Error('Not signed in');
    // Try to find a household where this user is an adult
    const { data, error } = await supabase
      .from('members')
      .select('household_id, role')
      .eq('user_id', user.id)
      .eq('role', 'adult')
      .limit(1)
      .maybeSingle();

    if (error) throw error;
    return data?.household_id || null;
  }

  initParentSeedButton(getActiveHouseholdId, supabase);
</script>
